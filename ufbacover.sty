%%%
% ufbacover - allow drawing the computer.ufba.br thesis cover using LaTeX
%%%
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{ufbacover}[2023/06/20 Ibirisol Fontes Ferreira
LaTeX package loading UFBA Cover Model with sketch commands]
\RequirePackage{afterpage}
\RequirePackage{geometry}
\RequirePackage{graphicx}
\RequirePackage{xcolor}
\RequirePackage{array}
\RequirePackage{ragged2e}
\RequirePackage{xspace}
\RequirePackage{kvoptions}
\RequirePackage[T1]{fontenc}
\RequirePackage[medium,semibold]{montserrat}
\RequirePackage[regular,semibold]{noto}

\newcommand\montserratfont[1]{{\fontfamily{Montserrat-TLF}\selectfont #1}}
\newcommand\notofont[1]{{\fontfamily{NotoSans-TLF}\selectfont #1}}

\newcommand\headerfont[1]{\montserratfont{#1}}
\newcommand\bodyfont[1]{\notofont{#1}}

% options
\DeclareStringOption[452mm]{coverwidth}[452mm]
\DeclareStringOption[317mm]{coverheight}[317mm]
\DeclareStringOption[1.0]{coverscale}[1.0]
\DeclareOption*{\PackageWarning{ufbacover}{Unknown '\CurrentOption'}}
\ProcessOptions\relax

% commands
\newcommand{\CoverWidth}{\ufbacover@coverwidth}
\newcommand{\CoverHeight}{\ufbacover@coverheight}
\newcommand{\CoverScale}{\ufbacover@coverscale}
\newcommand{\coverwidth}[1]{\def\CoverWidth{#1}}
\newcommand{\coverheight}[1]{\def\CoverHeight{#1}}
\newcommand{\coverscale}[1]{\def\CoverScale{#1}}
\newcommand{\covertype}[1]{\def\CoverType{#1}}
\newcommand{\covercode}[1]{\def\CoverCode{#1}}
\newcommand{\covermonth}[1]{\def\CoverMonth{#1}}
\newcommand{\coveryear}[1]{\def\CoverYear{#1}}
\newcommand{\coverdocumenttype}[1]{\def\CoverDocumentType{#1}}
\newcommand{\covertitle}[1]{\def\CoverTitle{#1}}
\newcommand{\coverauthor}[1]{\def\CoverAuthor{#1}}
\newcommand{\coverabstract}[1]{\def\CoverAbstract{#1}}
\newcommand{\coverkeywords}[1]{\def\CoverKeywords{#1}}

% adapted commands from inkscape
\providecommand\color[2][]{%
  \errmessage{Color is used for the text and cover art, but the package 'color.sty' is not loaded}%
  \renewcommand\color[2][]{}%
}%
\providecommand\definecolor[3][]{%
  \errmessage{Defined color is used for the text and cover art, but the package 'xcolor.sty' is not loaded}%
  \renewcommand\definecolor[3]{}{}{}%
}%

\providecommand\rotatebox[2]{#2}%
\providecommand*\fsize{\dimexpr\f@size pt\relax}%
\providecommand*\lineheight[1]{\fontsize{\fsize}{#1\fsize}\selectfont}%

% new commands for betters tabular adjustments
\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}p{#1}}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}p{#1}}
\newcolumntype{M}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}p{#1}}
\newcolumntype{J}[1]{>{\justify\let\newline\\\arraybackslash\hspace{0pt}}p{#1}}

% cover page layout parameter
\def\svgwidth{\CoverWidth}
\def\svgheight{\CoverHeight}
\def\svgscale{\CoverScale}

\ifx\svgwidth\undefined%
    \setlength{\unitlength}{1mm}%
    \ifx\svgscale\undefined%
        \relax%
    \else%
        \setlength{\unitlength}{\unitlength * \real{\svgscale}}%
    \fi%
\else%
    \setlength{\unitlength}{\svgwidth}%
\fi%

% cover colors
\definecolor{coverDarkBlue}{cmyk}{0.99, 0.96, 0.25, 0.21}
\definecolor{coverDarkBlueLight}{cmyk}{0.6, 0.4, 0, 0.4}
\definecolor{coverBlue}{cmyk}{1.0, 0.2, 0, 0}
\definecolor{coverBlueLight}{cmyk}{0.4, 0, 0, 0}
\definecolor{coverWhite}{cmyk}{0, 0, 0, 0}

% cover art drawing
\newcommand{\artrecta}[2][coverBlue]{
    \put(0,0.48695){#2\colorbox{#1}{\makebox(0.4317,0.212){}}}
}

\newcommand{\artrectb}[2][coverDarkBlue]{
    \put(0.5118,0){#2\colorbox{#1}{\makebox(0.4836,0.43452){}}}
}

\newcommand{\artrectc}[2][coverBlue]{
    \put(0.43585,0){#2\colorbox{#1}{\makebox(0.15022,0.098456){}}}
}

\newcommand{\artlines}{
    % left top
    \put(0.02213,0.70132751){\color{white}\line(0,-1){0.0177}}
    \put(0,0.67919751){\color{white}\line(1,0){0.0177}}
    % left bottom
    \put(0.02213,0){\line(0,1){0.0177}}
    \put(0,0.02213){\line(1,0){0.0177}}
    % center top
    \put(0.4867,0.70132751){\line(0,-1){0.0177}}
    \put(0.5128,0.70132751){\line(0,-1){0.0177}}
    % center bottom
    \put(0.4867,0){\color{white}\line(0,1){0.0177}}
    \put(0.5128,0){\color{white}\line(0,1){0.0177}}
    % right top
    \put(0.97736,0.70132751){\line(0,-1){0.0177}}
    \put(1,0.6788){\line(-1,0){0.0177}}
    % right bottom
    \put(0.97736,0){\color{white}\line(0,1){0.0177}}
    \put(1,0.0218){\color{white}\line(-1,0){0.0177}}
}

\newcommand{\artlogo}{
    \put(0.5357,0.037){\includegraphics[width=14.76mm]{brasao_ufba.pdf}}
}

% front cover text commands
\newcommand{\artcoverfronttitle}[5][coverDarkBlue]{
    \put(0.58607,0.57991487){\color{#1}\makebox(0,0)[lt]{\lineheight{#5}\smash{\begin{tabular}[t]{R{0.74\textwidth}}\fontsize{#2}{#3}\headerfont{#4}\end{tabular}}}}
}

\newcommand{\artcoverfrontauthor}[4][coverWhite]{
    \put(0.58607,0.33259119){\color{#1}\makebox(0,0)[lt]{\lineheight{1.25}\smash{\begin{tabular}[t]{R{0.74\textwidth}}\fontsize{#2}{#3}\bodyfont{#4}\end{tabular}}}}
}

\newcommand{\artcoverfrontdocumenttype}[4][coverBlueLight]{
    \put(0.58607,0.21391464){\color{#1}\makebox(0,0)[lt]{\lineheight{1.25}\smash{\begin{tabular}[t]{>{\raggedleft}p{0.74\textwidth}}\fontsize{#2}{#3}\bodyfont{#4}\end{tabular}}}}
}

\newcommand{\CoverInfo}{
    \bodyfont{Universidade Federal da Bahia}\\\\\bodyfont{Programa de Pós-Graduação em}\\\bodyfont{Ciência da Computação}\\\\\bodyfont{\CoverMonth\xspace|\xspace\CoverYear}
}

\newcommand{\artcoverfrontinfo}[4][coverWhite]{
    \put(0.59070796,0.18218165){\color{#1}\makebox(0,0)[lt]{\lineheight{2}\smash{\fontsize{#2}{#3}\begin{tabular}[t]{R{0.73\textwidth}} #4 \end{tabular}}}}
}

% back cover text commands
\newcommand{\PGCOMPAddressInfo}{
    \bodyfont{PGCOMP - Programa de Pós-Graduação em Ciência da Computação}\\\bodyfont{Universidade Federal da Bahia (UFBA)}\\\bodyfont{Av. Milton Santos, s/n - Ondina}\\\bodyfont{Salvador, BA, Brasil, 40170-110}\\\\\bodyfont{https://pgcomp.ufba.br}\\\bodyfont{pgcomp@ufba.br}
}

\newcommand{\artcoverbackaddressinfo}[4][coverWhite]{
    \put(0.12603759,0.6124423){\color{#1}\makebox(0,0)[lt]{\lineheight{1.466}\smash{\fontsize{#2}{#3}\begin{tabular}[t]{l}#4\end{tabular}}}}
}

\newcommand{\artcoverbackabstractkeywords}[5][coverDarkBlueLight]{
    \put(0.12603759,0.46617283){\color{#1}\makebox(0,0)[lt]{\lineheight{1.25}\smash{\begin{tabular}[t]{J{0.65\textwidth}}\fontsize{#2}{#3}\bodyfont{#4}\newline\bodyfont{#5}\end{tabular}}}}
}

% spine text commands
\newcommand{\CoverSpineInfo}{
    \xspace\CoverType\xspace|\xspace\CoverCode\xspace|\xspace\CoverYear\xspace
}

\newcommand{\artcoverspineinfo}[4][coverBlue]{
    \put(0.49782899,0.63889314){\color{#1}\rotatebox{-90}{\makebox(0,0)[lt]{\lineheight{1.25}\smash{\begin{tabular}[t]{l}\fontsize{#2}{#3}\bodyfont{#4}\end{tabular}}}}}
}

\newcommand{\artcoverspinetitle}[4][coverDarkBlue]{
    \put(0.49644488,0.5493505){\color{#1}\rotatebox{-90}{\makebox(0,0)[lt]{\lineheight{1.25}\smash{\begin{tabular}[t]{C{0.69\textwidth}}\fontsize{#2}{#3}\bodyfont{#4}\end{tabular}}}}}
}

\newcommand{\artcoverspineauthor}[4][coverDarkBlue]{
    \put(0.4963,0.20886039){\color{#1}\rotatebox{-90}{\makebox(0,0)[lt]{\lineheight{1.25}\smash{\begin{tabular}[t]{M{0.225\textwidth}}\fontsize{#2}{#3}\bodyfont{#4}\end{tabular}}}}}
}

\newcommand{\artcoverspineinstitution}[3][coverWhite]{
    \put(0.4950728,0.07637041){\color{#1}\rotatebox{-90}{\makebox(0,0)[lt]{\lineheight{1.25}\smash{\begin{tabular}[t]{l}\fontsize{#2}{#3}\bodyfont{UFBA}\end{tabular}}}}}
}

% cover with sketched background command
\newcommand{\newcover}{
    %% cover art with latex
    \afterpage{
        \thispagestyle{empty}
        \newgeometry{margin=0mm}
        \eject \pdfpagewidth=\CoverWidth \pdfpageheight=\CoverHeight
        \begin{figure}
            \begin{picture}(1,0.70132751)%
                \lineheight{1}%
                \setlength\tabcolsep{0pt}%
                % cover background art
                \artrecta{}
                \artrectb{}
                \artrectc{}
                \artlogo
                % add crop lines
                \artlines
                % cover text
                % call front cover elements
                \artcoverfronttitle{32}{1.25}{\CoverTitle}{3.9}
                \artcoverfrontauthor{25}{1.25}{\CoverAuthor}
                \artcoverfrontdocumenttype{18}{1.25}{\CoverDocumentType}
                \artcoverfrontinfo{15}{1.25}{\CoverInfo}
                % call back cover elements
                \artcoverbackabstractkeywords{10}{13.355}{\CoverAbstract}{\CoverKeywords}
                \artcoverbackaddressinfo{11}{1.25}{\PGCOMPAddressInfo}
                % call spine elements
                \artcoverspineinstitution{14}{1.25}
                \artcoverspineinfo{12}{1.25}{\CoverSpineInfo}
                \artcoverspinetitle{11}{1.25}{\CoverTitle}
                \artcoverspineauthor{12}{12.8}{\CoverAuthor}
            \end{picture}
        \end{figure}
        \restoregeometry
    }
}

\endinput